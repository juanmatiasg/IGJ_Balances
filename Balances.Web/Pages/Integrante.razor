@page "/Integrante/{balid?}"
@using Balances.DTO;
@using Balances.Utilities;
@using Balances.Web.Services.Contracts;
@using Balances.Web.Services.Implementation;

@using FluentValidation.Results

@inject ISociosClientService socioService
@inject IBalanceClientService balanceService
@inject ISessionClientService sesionService
@inject Blazored.SessionStorage.ISessionStorageService sessionStorage
@inject Blazored.LocalStorage.ILocalStorageService LocalStorage
@inject SweetAlertService swal;
@inject NotificationService notificationService

<Navegacion TramiteIniciado=true PaginaActiva="Integrante" balid="@balid"></Navegacion>


<NavegacionIntegrantes PaginaActiva="Integrante" TramiteIniciado=true balid="@balid"></NavegacionIntegrantes>


<!-- Formulario de Datos del Integrante -->
<div class="container">

    <!--FORMULARIO PERSONA-->

    <div class="d-flex gap-1" style="color:#15153D">

        <div class="card d-flex justify-content-between w-50">
            <EditForm Model="@model">

                <div class="card-header" style="color: #FFF;background-color:#15153D; font-weight: bold; text-align: center;">
                    Datos de Persona Humana
                </div>

                <div class="card-body d-flex flex-column gap-1 w-100 ">

                    <FluentValidationValidator />

                    <!--NOMBRE Y APELLIDO-->


                    <div class="d-flex gap-1 ">

                        <RadzenStack Style="width:50%">
                            <RadzenFormField Text="Nombre">
                                <RadzenTextBox @bind-Value="@model.Nombre" />
                            </RadzenFormField>
                            <ValidationMessage For="@(()=> model.Nombre)" />

                        </RadzenStack>


                        <RadzenStack Style="width:50%">
                            <RadzenFormField Text="Apellido">
                                <RadzenTextBox @bind-Value="@model.Apellido" />
                            </RadzenFormField>
                            <ValidationMessage For="@(()=> model.Apellido)" />

                        </RadzenStack>
                    </div>



                    <!--DOCUMENTO-->
                    <div class="d-flex justify-content-between w-100 gap-1">

                        <RadzenStack Style="width:30%;">
                            <RadzenFormField Text="Tipo de Documento">
                                <RadzenDropDown @bind-Value=@model.TipoDocumento Data=@tiposDocumentos Name="DropDownBindValue" />
                            </RadzenFormField>
                            <ValidationMessage For="@(()=> model.TipoDocumento)" />
                        </RadzenStack>

                        <RadzenStack Style="width:30%;">
                            <RadzenFormField Style="width:100%" Text="Nro. de CUIL/CUIT">
                                <RadzenTextBox @bind-Value="@model.NroFiscal" />
                            </RadzenFormField>
                            <ValidationMessage For="@(()=> @model.NroFiscal)" />
                        </RadzenStack>

                        <RadzenStack Style="width:30%;">
                            <RadzenFormField Style="width:100%" Text="Nro. de Documento">
                                <RadzenTextBox @bind-Value="@model.NroDocumento" />
                            </RadzenFormField>
                            <ValidationMessage For="@(()=> @model.NroDocumento)" />
                        </RadzenStack>

                    </div>



                    <!--ACCIONES Y VOTOS-->
                    <div class="d-flex gap-1 ">

                        <RadzenStack Style="width:50%">
                            <RadzenFormField Text="Cantidad de Acciones">
                                <RadzenTextBox @bind-Value="@model.Cuotas" />
                            </RadzenFormField>
                            <ValidationMessage For="@(()=> model.Cuotas)" />
                        </RadzenStack>

                        <RadzenStack Style="width:50%">
                            <RadzenFormField Text="Cantidad de Votos">
                                <RadzenTextBox @bind-Value="@model.Votos" />
                            </RadzenFormField>
                            <ValidationMessage For="@(()=> model.Votos)" />
                        </RadzenStack>
                    </div>

                </div>
                <RadzenStack class="mt-4 mb-2">
                    <RadzenButton ButtonType="Radzen.ButtonType.Submit" ButtonStyle="ButtonStyle.Primary" Click="@InsertPersonaHumana">Agregar</RadzenButton>
                </RadzenStack>
            </EditForm>
        </div>


        <div class="card d-flex justify-content-between w-50">


            <!-- Lista de Integrantes -->
            <div class="card-header" style="color: #FFF;background-color:#15153D; font-weight: bold; text-align: center;">
                Listado de Persona Humana
            </div>


            <div class="card-body">
                <RadzenGrid @ref="grid" Data="listPersonaHumana" TItem="PersonaHumanaDto">
                    <Columns>

                        <RadzenGridColumn TItem="PersonaHumanaDto" Width="8rem" Title="Nombre y Apellido">
                            <Template Context="data">
                                @($"{data.Nombre} {data.Apellido}")
                            </Template>
                        </RadzenGridColumn>
                        <RadzenGridColumn TItem="PersonaHumanaDto" Width="8rem" Title="Nro. Documento">
                            <Template Context="data">
                                @($"{data.TipoDocumento} {data.NroDocumento}")<br /> @($"Cuit {data.NroFiscal}")
                            </Template>
                        </RadzenGridColumn>
                        <RadzenGridColumn TItem="PersonaHumanaDto" Width="4rem" Property="Cuotas" Title="Acciones" />
                        <RadzenGridColumn TItem="PersonaHumanaDto" Width="4rem" Property="Votos" Title="Votos" />
                        <RadzenGridColumn TItem="PersonaHumanaDto" Width="4rem">
                            <Template Context="personaHumana">
                                <RadzenButton Icon="delete" ButtonStyle="ButtonStyle.Danger" Click="@(() => deletePersonaHumana(personaHumana))"></RadzenButton>
                            </Template>
                        </RadzenGridColumn>


                    </Columns>
                </RadzenGrid>

            </div>
        </div>

    </div>
</div>














