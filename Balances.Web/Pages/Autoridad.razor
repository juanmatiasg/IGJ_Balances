@page "/Autoridad/{balid?}"
@using Balances.DTO;
@using Balances.Utilities;
@using Balances.Web.Services.Contracts;
@using Balances.Web.Services.Implementation;

@inject IAutoridadClientService autoridadService
@inject ISessionClientService sesionService
@inject IBalanceClientService balanceService
@inject Blazored.SessionStorage.ISessionStorageService sessionStorage
@inject Blazored.LocalStorage.ILocalStorageService LocalStorage

@inject NavigationManager NavigationManager



<Modal @ref="modalRef">
    <ModalContent Centered>
        <ModalHeader>
            <ModalTitle>Autoridades</ModalTitle>
            <CloseButton />
        </ModalHeader>
        <ModalBody>
            <p class="d-flex justify-content-center">No puede haber más dos firmantes.</p>
        </ModalBody>
        <ModalFooter>
            <Button Color="Color.Secondary" Clicked="@HideModal">Close</Button>
        </ModalFooter>
    </ModalContent>
</Modal>


<Navegacion Entidad="@($"{TipoEntidad}")" PaginaActiva="Autoridad" TramiteIniciado="true" balid="@balid"></Navegacion>


<!---------------------------------------------------------------->
<div class="row">
    <div class="col-md-6">
        <div class="container-fluid mt-4">
            <div class="card">
                <div class="card-header" style="color: #0375bc; font-weight: bold; text-align: center;">
                    Datos de la Autoridad
                </div>

                <div class="card-body">
                    <form>
                       
                            <div class="form-group mt-2 mb-2">
                                <RadzenFormField Text="Nombre" Style="width:100%">
                                    <RadzenTextBox @bind-Value="@modelo.Nombre" Style="width:100%" />
                                </RadzenFormField>

                                <small id="msgError" class="text-danger">@msgErrorNombre</small>
                            </div>

                            <div class="form-group mt-2 mb-2">
                                <RadzenFormField Text="Apellido" Style="width:100%">
                                    <RadzenTextBox @bind-Value="@modelo.Apellido" Style="width:100%" />
                                </RadzenFormField>

                                <small id="msgError" class="text-danger">@msgErrorApellido</small>
                            </div>

                            <div class="form-group mt-2 mb-2">
                                <RadzenDropDown @bind-Value=@modelo.TipoDocumento Data=@tiposDocumentos Name="DropDownBindValue" Placeholder="Tipo de Documento" Style="width:100%" />
                                <small id="msgError" class="text-danger">@msgErrorTipoDeDoc</small>
                            </div>

                            <div class="form-row">
                                <div class="form-group mt-2 mb-2">
                                    <RadzenFormField Text="Nro. de Documento" Style="width:100%">
                                        <RadzenTextBox @bind-Value="@modelo.NroDocumento" Style="width:100%" />
                                    </RadzenFormField>
                                    <small id="msgError" class="text-danger">@msgErrorNroDoc</small>
                                </div>

                                <div class="form-group mt-2 mb-2">
                                    <RadzenFormField Text="Número de Identificación Fiscal" Style="width:100%">
                                        <RadzenTextBox @bind-Value="@modelo.NroFiscal" Style="width:100%" />
                                    </RadzenFormField>

                                    <small id="msgError" class="text-danger">@msgErrorNroIdFiscal</small>
                                </div>

                                <div class="form-group mt-2 mb-2">

                                    <RadzenFormField Text="Cargo" Style="width:100%">
                                        <RadzenTextBox @bind-Value="@modelo.Cargo" Style="width:100%" />
                                    </RadzenFormField>

                                    <small id="msgError" class="text-danger">@msgErrorCargo</small>
                                </div>
                            </div>
                            <div class="form-group form-check mt-2 mb-2">
                                <input type="checkbox" class="form-check-input" id="checkboxFirmante" @bind="modelo.EsFirmante">
                                <label class="form-check-label" for="checkboxFirmante">Es Firmante</label>
                            </div>

                            <div class="d-flex justify-content-center mt-2">
                                <RadzenButton ButtonStyle="ButtonStyle.Primary" Click="@insertAutoridad">Agregar</RadzenButton>
                            </div>
                       

                    </form>
                </div>
            </div>
        </div>
    </div>



    <div class="col-md-6">
        <div class="container mt-4">
            <div class="card">
                <div class="card-header" style="color: #0375bc; font-weight: bold; text-align: center;">
                    Autoridades
                </div>
                <div class="card-body mb-4">

                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th scope="col">Apellido y Nombre</th>
                                <th scope="col">Nro Documento</th>
                                <th scope="col">CUIT</th>
                                <th scope="col">Cargo</th>
                                <th scope="col">Firmante</th>
                                <th scope="col">Acción</th>

                            </tr>
                        </thead>
                        @foreach (var autoridad in listAutoridades)
                        {
                            <tbody>
                                <tr>
                                    <td>@autoridad.Apellido @autoridad.Nombre</td>
                                    <td>@autoridad.NroDocumento</td>
                                    <td>@autoridad.NroFiscal</td>
                                    <td>@autoridad.Cargo</td>
                                    <td>@(autoridad.EsFirmante ? "Sí" : "No")</td>
                                    <td>
                                        <button type="button" class="btn btn-danger" @onclick="() => deleteAutoridad(autoridad)">Eliminar</button>
                                    </td>
                                </tr>
                            </tbody>
                        }
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>










